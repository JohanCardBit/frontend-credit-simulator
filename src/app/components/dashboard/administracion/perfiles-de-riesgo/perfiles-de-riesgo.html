<div class="riesgo-container">

  <!-- Encabezado -->
  <div class="header-riesgo">
    <h2>Perfiles de riesgo</h2>
    <label (click)="limpiarModal()" class="btn-crear" for="modalCrear">+ Crear perfil</label>
  </div>

  <!-- Contenedor de tarjetas -->
  <div class="cards-riesgo">

    @for (item of perfiles; track $index) {
    <div class="card-riesgo glass">
      <div class="card-header">
        <span class="categoria categoria-{{item.category}}">Categoría {{item.category}}</span>
        <div class="acciones">
          <label (click)="verCategoria(item._id)" class="icon-btn" for="modalEditar">
             <svg width="20" height="25" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M12.8452 3.51265L16.4873 7.15476L6.84524 16.7968L3.33333 17.5L4.03651 13.9878L12.8452 3.51265ZM18.006 5.6369C18.3909 5.25208 18.3909 4.62451 18.006 4.2397L15.7603 1.99398C15.3755 1.60917 14.7479 1.60917 14.3631 1.99398L12.6131 3.74398L16.256 7.3869L18.006 5.6369Z"
                fill="#0084ff" />
            </svg>
          </label>
          <button (click)="eliminarPerfil(item._id)" class="icon-btn eliminar">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M7.5 3.33333L8.33333 2.5H11.6667L12.5 3.33333H16.6667V5H3.33333V3.33333H7.5ZM4.16667 6.66667H15.8333L15 16.25C15 17.4167 14.1667 18.3333 13.3333 18.3333H6.66667C5.83333 18.3333 5 17.4167 5 16.25L4.16667 6.66667Z"
                fill="#0084ff" />
            </svg>
          </button>
        </div>
      </div>

      <div class="card-body">
        <p><strong>Puntaje:</strong> {{item.maxScore}} - {{item.minScore}}</p>
        <p><strong>Tasa interés:</strong> {{item.interestRate}} %</p>
        <p class="desc">
          {{item.description}}
        </p>
      </div>
    </div>
    }
  </div>
</div>


<!-- ========================= -->
<!-- MODAL CREAR PERFIL -->
<!-- ========================= -->
<input type="checkbox" id="modalCrear" class="modal-toggle" hidden>

<div class="modal">
  <label for="modalCrear" class="modal-overlay"></label>

  <div [formGroup]="perfilForm" class="modal-content glass modal-riesgo">
    <h3>Crear perfil de riesgo</h3>

    <div class="form-riesgo">

      <div class="col">
        <label>Categoría</label>
        <select formControlName="category" class="form-control">
          <option value="">Seleccione...</option>
          <option value="A">A - Riesgo Bajo</option>
          <option value="B">B - Riesgo Medio</option>
          <option value="C">C - Riesgo Alto</option>
        </select>

        <label>Puntaje mínimo</label>
        <input formControlName="minScore" type="number" placeholder="Ej: 600">

        <label>Puntaje máximo</label>
        <input formControlName="maxScore" type="number" placeholder="Ej: 749">
      </div>

      <div class="col">
        <label>Tasa de interés (%)</label>
        <input formControlName="interestRate" type="number" placeholder="Ej: 10">

        <label>Descripción</label>
        <textarea formControlName="description" rows="5" placeholder="Descripción del perfil..."></textarea>
      </div>

    </div>

    <div class="acciones-modal">
      <button (click)="crearPerfilDeRiesgo()" class="btn-guardar">Guardar</button>
      <label for="modalCrear" class="btn-cerrar">Cerrar</label>
    </div>
  </div>
</div>


<!-- ========================= -->
<!-- MODAL EDITAR PERFIL -->
<!-- ========================= -->
<input type="checkbox" id="modalEditar" class="modal-toggle" hidden>

<div class="modal">
  <label for="modalEditar" class="modal-overlay"></label>

  <div [formGroup]="perfilForm" class="modal-content glass modal-riesgo">
    <h3>Editar perfil de riesgo {{perfilForm.get('category')?.value}}</h3>

    <div class="form-riesgo">

      <div class="col">

        <label>Puntaje mínimo</label>
        <input formControlName="minScore" type="number" value="750">

        <label>Puntaje máximo</label>
        <input formControlName="maxScore" type="number" value="900">

          <label>Tasa de interés (%)</label>
        <input formControlName="interestRate" type="number" value="5">
      </div>

      <div class="col">


        <label>Descripción</label>
        <textarea formControlName="description" rows="5">Riesgo bajo, excelente historial crediticio.</textarea>
      </div>

    </div>

    <div class="acciones-modal">
      <button (click)="actualizarPerfil()" class="btn-guardar">Guardar cambios</button>
      <label for="modalEditar" class="btn-cerrar">Cerrar</label>
    </div>
  </div>
</div>
